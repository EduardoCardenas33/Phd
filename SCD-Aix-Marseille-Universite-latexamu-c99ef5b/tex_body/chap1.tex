\chapter{Fluid simulation}
\chaptertoc{}

In fluid simulation, there are different approaches: the microscopic, 
the mesoscopic, and the macroscopic approach. In the microscopic approach, 
all the interactions between molecules are modeled. While this method provides a 
highly detailed representation of the fluid's behavior, it is extremely 
time-consuming due to the complexity of calculating every molecular interaction.

The mesoscopic approach, on the other hand, is based on kinetic theory. In this 
approach, a group of molecules is treated as a single entity. This method relies 
on statistical mechanics to describe the distribution of particles in a fluid and
how this distribution evolves over time. It provides a balance between 
computational efficiency and accuracy by focusing on the collective behavior of 
particles rather than individual interactions.

The macroscopic approach is the classical method, where the fluid is treated by
considering only its macroscopic properties, such as velocity, pressure, and 
temperature. This method typically involves solving the Navier-Stokes (NS) 
equations, which describe the motion of fluid substances.

In this manuscript, the mesoscopic approach is utilized, specifically through
 the Lattice Boltzmann Method (LBM). The LBM has proven its efficiency in 
 simulating fluid dynamics by significantly improving computational speed compared 
 to classical NS solvers.

To achieve this, some fundamental concepts from kinetic theory are introduced,
followed by an overview of the classical Lattice Boltzmann Method. 
Subsequently, the method used for the simulation of supercritical 
CO\textsubscript{2} is presented.

\section{Fundamentals on kinetic theory}

\section{Fundamentals on Lattice Boltzmann Method}

The Lattice Boltzmann Method (LBM) was developed in the late 1980s and has been used
for Computational Fluid Dynamics (CFD) since then. Specifically, the foundational
work on LBM can be traced back to the work of Frisch, Hasslacher, and Pomeau in 
1986, who introduced the Lattice Gas Automaton (LGA), which is the precursor to 
LBM. The LBM, as it is known today, evolved from these early developments in the 
late 1980s and early 1990s. This first method was only used for weakly compressible
flows, where the temperature is constant and a perfect gas equation is used to close
the system and being equivalent to a Navier-Stokes formulation. The method has 
evelouated from that basic formulation and nowadays permits the use of difficult 
equations of state and the use for High compressible flows. 
This section provides the main concepts and expressions used in the classical and 
more simplest LBM. For doing that, a brief introduction of the Boltzmann equation
is made. 

\subsection{Boltzmann equation}
The Boltzmann equation, formulated by Ludwig Boltzmann in 1872, is a fundamental
equation in statistical mechanics that describes the statistical behavior of a 
thermodynamic system out of equilibrium. It is used to study the dynamics of a 
gas at the microscopic level by considering the distribution function 
f($x$,$\xi$,$t$), which represents the number of particles at a given 
position $x$, with a given velocity $\xi$, at time $t$.

In order to see the time evolution, the total derivative of the distribution
function can be expressed as:

\begin{equation}
	\frac{\mathrm{d}f}{\mathrm{d}t} = 
	\left(\frac{\partial f}{\partial t}\right)\frac{\mathrm{d}t}{\mathrm{d}t}
	+\left(\frac{\partial f}{\partial x_{\beta}}\right)\frac{\mathrm{d}x_{\beta}}{\mathrm{d}t}
	+\left(\frac{\partial f}{\partial \xi_{\beta}}\right)\frac{\mathrm{d}\xi_{\beta}}{\mathrm{d}t}
\end{equation}

Looking each term, we can indentify and define $\frac{\mathrm{d}f}{\mathrm{d}t} = \Omega(f)$
as the collision operator, $\frac{\mathrm{d}t}{\mathrm{d}t}=1$, 
the particle velocity as $\frac{\mathrm{d}x_{\beta}}{\mathrm{d}t} = \xi_{\beta}$
and $\frac{\mathrm{d}\xi_{\beta}}{\mathrm{d}t} = \frac{F_{\beta}}{\rho}$.

Leading to the final expresion for the Boltzmann equation.

\begin{equation}
	\Omega(f) = \frac{\partial f}{\partial t} 
	+ \xi_{\beta}\frac{\partial f}{\partial x_{\beta}}
	+ \frac{F_{\beta}}{\rho}\frac{\partial f}{\partial \xi_{\beta}}
\end{equation}

This expression can be seen as an advection equation for the distribution 
function, where the collision operator acts as a source term.

In the first equation developed by Ludwig Boltzmann, the formulation for
the collision operator involved complex integrals and cumbersome mathematical 
operations, making the calculations difficult to achieve. In 1954, 
P. L. Bhatnagar, E. P. Gross, and M. Krook introduced the BGK collision 
operator in their seminal paper titled "A Model for Collision Processes 
in Gases. I. Small Amplitude Processes in Charged and Neutral One-Component 
Systems," published in Physical Review. The BGK collision operator 
simplifies these calculations by incorporating only a single relaxation time.

The next subsection is dedicated to show a little bit about the BGK collision 
operator and how it was constructed.

\subsection{BGK collision operator}
This collision operator could be seen as a linearization of the complicated 
collision operator proposed by Boltzmann. As any other collision operator,
it should respect the mass, momentum and energy conservation. In order to show
how his shape is constructed, a taylor expansion of the collision operator
around the equilibrium point is developed.

\begin{equation}
	\Omega(f) = \Omega|_{f^{eq}} 
	+ \Delta f \frac{\partial \Omega}{\partial f} \bigg|_{f^{eq}} 
	+ \mathrm{O}(\Delta f^2)
\end{equation}

As explained before, the collision operator evaluated at the equilibrium, should 
be equal to zero. Then the linearized expression to represent the collision
operator is represend by the equation xx....

\begin{equation}
	\Omega(f) \approx 
	(f-f^{eq}) \frac{\partial \Omega}{\partial f} \bigg|_{f^{eq}} 
\end{equation}

\subsection{Hybrid recursive regularised collision operator}

\subsection{Numerical Discretization}

\section{Unified Lattice Boltzmann method}